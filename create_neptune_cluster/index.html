<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Amazon Neptune Workshop"><link href=create_neptune_cluster/ rel=canonical><meta name=author content="Eryan Ariobowo"><link rel="shortcut icon" href=../assets/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.4.0"><title>Create Neptune Cluster - Amazon Neptune Workshop</title><link rel=stylesheet href=../assets/stylesheets/main.61729dd2.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e185632b.min.css><meta name=theme-color content=#3f51b5><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#creating-an-amazon-neptune-database-cluster class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=hhttps://master.d1bxk6edgkc8n1.amplifyapp.com/ title="Amazon Neptune Workshop" class="md-header-nav__button md-logo" aria-label="Amazon Neptune Workshop"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Amazon Neptune Workshop </span> <span class="md-header-nav__topic md-ellipsis"> Create Neptune Cluster </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/ejlp12/aws-workshop-neptune title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> ejlp12/aws-workshop-neptune </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=./ class="md-tabs__link md-tabs__link--active"> Hands on Lab </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=hhttps://master.d1bxk6edgkc8n1.amplifyapp.com/ title="Amazon Neptune Workshop" class="md-nav__button md-logo" aria-label="Amazon Neptune Workshop"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> Amazon Neptune Workshop </label> <div class=md-nav__source> <a href=https://github.com/ejlp12/aws-workshop-neptune title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> ejlp12/aws-workshop-neptune </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=About class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../getting-started/ title=Preparation class=md-nav__link> Preparation </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Hands on Lab <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Hands on Lab" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Hands on Lab </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Create Neptune Cluster <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="Create Neptune Cluster" class="md-nav__link md-nav__link--active"> Create Neptune Cluster </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#create-an-neptune-db-cluster-console class=md-nav__link> Create an Neptune DB cluster (Console) </a> </li> <li class=md-nav__item> <a href=#accessing-your-cluster class=md-nav__link> Accessing your cluster </a> <nav class=md-nav aria-label="Accessing your cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#allowing-connection class=md-nav__link> Allowing Connection </a> </li> <li class=md-nav__item> <a href=#test-connection class=md-nav__link> Test Connection </a> </li> <li class=md-nav__item> <a href=#setup-gremlin-console class=md-nav__link> Setup Gremlin Console </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../basic_gremlin/ title="Basic Gremlin" class=md-nav__link> Basic Gremlin </a> </li> <li class=md-nav__item> <a href=../loading_data/ title="Loading Data" class=md-nav__link> Loading Data </a> </li> <li class=md-nav__item> <a href=../work_with_notebook/ title="Working with Jupyter Notebook" class=md-nav__link> Working with Jupyter Notebook </a> </li> <li class=md-nav__item> <a href=../scenario1/ title="Explore Graph Data" class=md-nav__link> Explore Graph Data </a> </li> <li class=md-nav__item> <a href=../create_read_replica/ title="Create Read Replica" class=md-nav__link> Create Read Replica </a> </li> <li class=md-nav__item> <a href=../cloning_neptune/ title="Cloning Neptune" class=md-nav__link> Cloning Neptune </a> </li> <li class=md-nav__item> <a href=../snapshot_and_backup/ title="Snapshot and Backup" class=md-nav__link> Snapshot and Backup </a> </li> <li class=md-nav__item> <a href=../failover_neptune/ title=Failover class=md-nav__link> Failover </a> </li> <li class=md-nav__item> <a href=../basic_monitoring/ title="Basic Monitoring" class=md-nav__link> Basic Monitoring </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#create-an-neptune-db-cluster-console class=md-nav__link> Create an Neptune DB cluster (Console) </a> </li> <li class=md-nav__item> <a href=#accessing-your-cluster class=md-nav__link> Accessing your cluster </a> <nav class=md-nav aria-label="Accessing your cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#allowing-connection class=md-nav__link> Allowing Connection </a> </li> <li class=md-nav__item> <a href=#test-connection class=md-nav__link> Test Connection </a> </li> <li class=md-nav__item> <a href=#setup-gremlin-console class=md-nav__link> Setup Gremlin Console </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=creating-an-amazon-neptune-database-cluster>Creating an Amazon Neptune Database Cluster<a class=headerlink href=#creating-an-amazon-neptune-database-cluster title="Permanent link">&para;</a></h1> <p>An Amazon Neptune DB cluster consists of one or more DB instances and a cluster volume that represents the data for the DB cluster, copied across three Availability Zones as a single, virtual volume. The DB cluster contains a Primary DB Instance and, optionally, up to 15 Neptune Replicas.</p> <ul> <li><strong>Primary DB instance</strong> – <mark>Supports read and write</mark> operations and performs all the data modifications to the cluster volume. Each Neptune DB cluster <mark>has one primary DB instance</mark>.</li> <li><strong>Neptune replica</strong> – Connects to the <mark>same storage volume</mark> as the primary DB instance and <mark>supports only read</mark> operations. </li> </ul> <p>In this section, we will create a simple Neptune DB cluster with a primary node and a standby node.</p> <h2 id=create-an-neptune-db-cluster-console>Create an Neptune DB cluster (Console)<a class=headerlink href=#create-an-neptune-db-cluster-console title="Permanent link">&para;</a></h2> <ol> <li>In the AWS Management Console, on the <strong>Services</strong> menu, click <a href=https://console.aws.amazon.com/rds/ >Neptune</a>.</li> <li>In the top-right bar, select the AWS <strong>Region</strong> in which you want to create the Neptune DB cluster. </li> <li> <p>In the <strong>Dashboard</strong> page, click <strong>Launch Amazon Neptune</strong>.</p> <p><img alt src=../assets/images/neptune-console.png></p> </li> <li> <p>In the <strong>Engine options</strong> section, select latest version <strong>Neptune 1.0.2.2.R2</strong></p> </li> <li> <p>On the <strong>Setting</strong>, specify <strong>DB cluster identifier</strong> <mark><code>neptune-{YOUR_NAME}-cluster</code></mark> (for example: <code>neptune-ejlp-cluster</code>)</p> </li> <li> <p>For <strong>Templates</strong>, select <strong>Production</strong>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Selecting this option will makes Amazon Neptune maintain a synchronous replica in a different Availability Zone than the Primary DB instance. Amazon Neptune will automatically fail over to the replica in the case of a planned or unplanned outage of the Primary.</p> </div> </li> <li> <p>For <strong>DB instance size</strong>, select <code>db.r5.large</code> as the type of your EC2 instance for running the Neptune instance</p> </li> <li> <p>On the <strong>Availability &amp; durability</strong>, select <strong>Create read replica in different AZ</strong></p> </li> <li> <p>On the <strong>Connectivity</strong>, configure as following</p> <ul> <li><strong>VPC</strong>: Use default</li> <li><strong>Subnet group</strong>: Use default</li> <li><strong>VPC security groups</strong>: Create new VPC Security group, <mark><code>sg_neptune_{YOUR_NAME}</code></mark></li> <li><strong>Database Port</strong>: Use default (8182)</li> </ul> </li> <li> <p>It is good to always having a tag, add a Tag with "Key": <code>purpose</code> and "Value": <code>workshop-july-2020</code></p> </li> <li> <p>Click <strong>Additional Configuration</strong>, Database options</p> <ul> <li><strong>DB instance identifier</strong>: <mark><code>neptune-{YOUR_NAME}</code></mark></li> <li><strong>DB parameter group</strong>: <strong>default.neptune1</strong></li> <li><strong>DB cluster parameter group</strong>: <strong>default.neptune1</strong></li> <li><strong>Failover Priority</strong>: <strong>No preference</strong></li> <li><strong>Backup retention period</strong>: <strong>1 day</strong></li> <li>Uncheck <strong>Enable Encryption</strong></li> <li>Uncheck <strong>Audit Log</strong></li> <li>On Maintenance setting:</li> <li>Check <strong>Enable auto minor version upgrade</strong> </li> <li>Choose <strong>Select window</strong> for maintenance, and set the time as you wish</li> <li>Uncheck <strong>Enable deletion protection</strong></li> </ul> <p>Examine all the fields, and leave the remanding sections to their default values and go to the bottom of the page. </p> </li> <li> <p>Click <strong>Create database</strong></p> <blockquote> <p>Note: After clicking Create database the creating process will take some time to complete. You need to wait and click reload button on the top of the list for several times. </p> </blockquote> <p>You will see a cluster consist of one Primary (Writer) and one Replica (Reader) created.</p> <p><img alt="Creating Neptune database" src=../assets/images/neptune_creating.png></p> </li> <li> <p>When your database instance status changes to Available. Click <mark><code>neptune-{yourname}-cluster</code></mark> from the <strong>DB indentifier</strong> column</p> </li> <li> <p>Scroll down to <strong>Connectivity &amp; Security</strong> section and note down your <strong>Endpoints</strong> (both the Reader and Writer endpoint). These endpoints are needed in later sections of the lab.</p> <p><img alt="Neptune Endpoint" src=../assets/images/neptune-endpoint.png></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>When you have a read Replica, the reader endpoint will automatically use read replica for all read only queries. But if you only have one Neptune instance then reader endpoint will use Primary DB instance. </p> </div> </li> </ol> <p>Up to this point, you have created a new Neptune cluster with a Primary and Replica node. The Replica node <code>neptune-{yourname}-{region-az}</code> can be promoted to Primary if the existing Primary database goes down. </p> <p>In the next section, we will access the Primary Neptune node.</p> <h2 id=accessing-your-cluster>Accessing your cluster<a class=headerlink href=#accessing-your-cluster title="Permanent link">&para;</a></h2> <p>In this lab, you will run some Gremlin commands remotely from the local computer or the Cloud9 IDE. </p> <h3 id=allowing-connection>Allowing Connection<a class=headerlink href=#allowing-connection title="Permanent link">&para;</a></h3> <p>In order to access the Neptune cluster, you will need to open up proper <strong>security groups</strong> to enable connection between your local computer (or Cloud9 instance) and the Neptune node. </p> <p>To enable the traffic going through Neptune cluster, perform the following:</p> <ol> <li>Click the Witer (Primary) database <mark><code>neptune-{yourname}</code></mark>, then scroll down your page.</li> <li> <p>On the <strong>Connectivity &amp; security</strong> tab, select the security group that has Type: <strong>CIDR/IP - Inbound</strong></p> <p><img alt src=../assets/images/neptune_instance_detail_connectivity.png></p> </li> <li> <p>Click on the <strong>Inbound rules</strong> tab</p> <p><img alt src=../assets/images/edit_security_group.png></p> </li> <li> <p>Click on <strong>Edit inbound rules</strong></p> </li> <li> <p>Modify the existing inbound rule </p> <ul> <li>Type: <code>Custom TCP</code> </li> <li>Port: <code>8182</code></li> <li>For <strong>Source</strong> fill in with your IP address of your machine and specify the address using the <code>/32</code> prefix length. Or you can make Neptune accessible from anywhere using <code>0.0.0.0/0</code> (This is not recommended for production!) </li> </ul> <div class="admonition tips"> <p class=admonition-title>Knowing your IP address</p> <p>You can use a browser to know your IP address by accessing <a href=http://ifconfig.co>http://ifconfig.co</a> or use command <code>curl ifconfig.co</code></p> </div> <p><img alt src=../assets/images/edit_security_group_inbound.png></p> </li> <li> <p>Click <strong>Save rules</strong></p> </li> </ol> <h3 id=test-connection>Test Connection<a class=headerlink href=#test-connection title="Permanent link">&para;</a></h3> <p>You can now test our connection to Neptune Primary node's endpoint URL via HTTPS. </p> <p>We will use AWS Cloud9, an online Intergrated Development Environment (IDE) that can be accessed from your browser.</p> <ol> <li> <p>Open your Cloud9 tab in your browser.</p> </li> <li> <p>To connect to Neptune using HTTPS/WebSocket, you need an SSL CA certificate from AWS.</p> <p>Run this commands in the Terminal of your Cloud9 IDE.</p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> /home/ec2-user/environment/
wget https://www.amazontrust.com/repository/SFSRootCAG2.pem
</code></pre></div> </li> <li> <p>Set location of CA certificate for <code>curl</code> </p> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>CURL_CA_BUNDLE</span><span class=o>=</span>/home/ec2-user/environment/SFSRootCAG2.pem 
</code></pre></div> </li> <li> <p>Use this command to check the status of the Neptune instance</p> <p><div class=highlight><pre><span></span><code>curl -v https://your-neptune-endpoint:8182/status 
</code></pre></div> If connection successful you shoud get a response similar to this: <div class=highlight><pre><span></span><code><span class=p>{</span> <span class=nt>&quot;status&quot;</span><span class=p>:</span><span class=s2>&quot;healthy&quot;</span><span class=p>,</span>
  <span class=nt>&quot;startTime&quot;</span><span class=p>:</span><span class=s2>&quot;Sat Jul 18 06:35:36 UTC 2020&quot;</span><span class=p>,</span>
  <span class=nt>&quot;dbEngineVersion&quot;</span><span class=p>:</span><span class=s2>&quot;1.0.2.2.R2&quot;</span><span class=p>,</span>
  <span class=nt>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;writer&quot;</span><span class=p>,</span>
  <span class=nt>&quot;gremlin&quot;</span><span class=p>:{</span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=s2>&quot;tinkerpop-3.4.3&quot;</span><span class=p>},</span>
  <span class=nt>&quot;sparql&quot;</span><span class=p>:{</span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=s2>&quot;sparql-1.1&quot;</span><span class=p>},</span>
  <span class=nt>&quot;labMode&quot;</span><span class=p>:{</span>
     <span class=nt>&quot;ObjectIndex&quot;</span><span class=p>:</span><span class=s2>&quot;disabled&quot;</span><span class=p>,</span>
     <span class=nt>&quot;ReadWriteConflictDetection&quot;</span><span class=p>:</span><span class=s2>&quot;enabled&quot;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></p> </li> <li> <p>Try to access graph data using Gremlin via REST API. </p> <p>This command will get the vertexs (nodes) but limit the result to only one vertex. Change <code>{your-neptune-endpoint}</code> to your real Neptune endpoint.</p> <div class=highlight><pre><span></span><code>curl -X POST -d &#39;{&quot;gremlin&quot;:&quot;g.V().limit(1)&quot;}&#39; \
https://{your-neptune-endpoint}:8182/gremlin
</code></pre></div> </li> <li> <p>You can also try simple SPARQL query</p> <div class=highlight><pre><span></span><code>curl -v  -X POST \
--data-binary &#39;query=select ?s ?p ?o where {?s ?p ?o}&#39; \
https://{your-neptune-endpoint}:8182/sparql
</code></pre></div> <p>Because we are querying an <strong>empty</strong> DB, the result is very predictable: <div class=highlight><pre><span></span><code><span class=p>{</span>
    <span class=nt>&quot;head&quot;</span> <span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;vars&quot;</span> <span class=p>:</span> <span class=p>[</span> <span class=s2>&quot;s&quot;</span><span class=p>,</span> <span class=s2>&quot;p&quot;</span><span class=p>,</span> <span class=s2>&quot;o&quot;</span> <span class=p>]</span>
  <span class=p>},</span>
  <span class=nt>&quot;results&quot;</span> <span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;bindings&quot;</span> <span class=p>:</span> <span class=p>[</span> <span class=p>]</span>
  <span class=p>}</span>
<span class=p>}</span>   
</code></pre></div></p> </li> </ol> <h3 id=setup-gremlin-console>Setup Gremlin Console<a class=headerlink href=#setup-gremlin-console title="Permanent link">&para;</a></h3> <p>The following section walks you through installing and configuring the Gremlin Console to connect remotely to a Neptune DB instance.</p> <p>The Gremlin Console is an interactive text based console. It allows you to experiment with TinkerPop graphs and queries in a REPL (read-eval-print loop) environment.</p> <ol> <li>Go to Cloud9 Console in your browser</li> <li> <p>Run this commands in the Terminal of your Cloud9 IDE. <div class=highlight><pre><span></span><code>sudo yum install -y java-1.8.0-devel <span class=o>&amp;&amp;</span> <span class=se>\</span>
sudo alternatives --set java /usr/lib/jvm/jre-1.8.0-openjdk.x86_64/bin/java <span class=o>&amp;&amp;</span> <span class=se>\</span>
<span class=nb>export</span> <span class=nv>JAVA_HOME</span><span class=o>=</span>/usr/lib/jvm/jre-1.8.0-openjdk.x86_64 <span class=o>&amp;&amp;</span> <span class=se>\</span>
wget https://archive.apache.org/dist/tinkerpop/3.4.1/apache-tinkerpop-gremlin-console-3.4.1-bin.zip <span class=o>&amp;&amp;</span> <span class=se>\</span>
unzip apache-tinkerpop-gremlin-console-3.4.1-bin.zip <span class=o>&amp;&amp;</span> <span class=se>\</span>
<span class=nb>cd</span> apache-tinkerpop-gremlin-console-3.4.1 <span class=o>&amp;&amp;</span> <span class=se>\</span>
wget https://www.amazontrust.com/repository/SFSRootCAG2.pem
</code></pre></div></p> <p>You can copy the command and paste in your terminal:</p> <p><img alt src=../assets/images/cloud9_install_gremlin_console.png></p> </li> <li> <p>In the <code>conf/</code> subdirectory of the extracted directory, create a file named <code>neptune-remote.yaml</code> with the following text. </p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <ul> <li>Replace <code>your-neptune-endpoint</code> with the hostname or IP address of your Neptune DB instance.</li> <li>The square brackets (<code>[ ]</code>) are required. </li> </ul> </div> <div class=highlight><pre><span></span><code>hosts: [your-neptune-endpoint]
port: 8182
connectionPool: { enableSsl: true, trustCertChainFile: &quot;SFSRootCAG2.pem&quot;}
serializer: { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { serializeResultToString: true }}
</code></pre></div> <p>Your file should look like this:</p> <p><img alt src=../assets/images/cloud9_gremlin_neptune_config.png></p> </li> <li> <p>Start Gremlin Console from your Terminal:</p> <p><div class=highlight><pre><span></span><code>bin/gremlin.sh
</code></pre></div> You are now at the <code>gremlin&gt;</code> prompt. You will enter the remaining steps at this prompt.</p> <p><img alt src=../assets/images/cloud9_gremlin_console_connected.png></p> </li> <li> <p>At the <code>gremlin&gt;</code> prompt, enter the following to connect to the Neptune DB instance. <div class=highlight><pre><span></span><code>:remote connect tinkerpop.server conf/neptune-remote.yaml
</code></pre></div></p> </li> <li> <p>At the <code>gremlin&gt;</code> prompt, enter the following to switch to remote mode. This sends all Gremlin queries to the remote connection. <div class=highlight><pre><span></span><code>:remote console
</code></pre></div></p> </li> <li> <p>Enter the following to send a query to the Gremlin Graph. This command basically will get vertexs on the database but we limit to only one vertex. <div class=highlight><pre><span></span><code>g.V().limit(1)
</code></pre></div> Since we don't have any data yet, the result will be empty.</p> </li> <li> <p>When you are finished, enter the following to exit the Gremlin Console. <div class=highlight><pre><span></span><code>:exit
</code></pre></div> Or you can also use <kbd>CTRL</kbd>-<kbd>D</kbd></p> </li> </ol> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../getting-started/ title=Preparation class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Preparation </div> </div> </a> <a href=../basic_gremlin/ title="Basic Gremlin" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Basic Gremlin </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> ejlp12@gmail.com </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.568ba93b.min.js></script> <script src=../assets/javascripts/bundle.2a81e305.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>